# 지하철 노선도 미션
[ATDD 강의](https://edu.nextstep.camp/c/R89PYi5H) 실습을 위한 지하철 노선도 애플리케이션

## 요구사항 정리

### 1주차. Step3 - 지하철 구간 관리
1. 구간 등록 기능
    - [x] 지하철 노선에 구간을 등록한다.
      - Given: 특정 노선이 등록되어 있고,
      - When: 노선에 새로운 구간을 등록하면,
      - Then: 노선 조회 시 구간이 등록되어있다.
    - [x] 존재하지 않는 역이 포함된 구간을 노선에 등록하면 오류를 응답한다.
       - Given: 특정 노선이 등록되어 있고,
       - When: 존재하지 않는 역이 포함된 구간을 노선에 등록하면,
       - Then: 오류를 응답한다.
    - [x] 존재하지 않는 노선에 구간을 등록하면 오류를 응답한다.
       - When: 존재하지 않는 노선에 구간을 등록하면,
       - Then: 오류를 응답한다.
    - [x] 새로운 구간의 상행역이 해당 노선의 하행역이 아니면 오류를 응답한다.
      - Given: 특정 노선이 등록되어 있고,
      - When: 노선의 하행역과 다른 역이 상행역인 구간을 등록하면,
      - Then: 오류를 응답한다.
    - [x] 이미 해당 노선에 등록되어 있는 역을 새로운 구간의 하행역으로 등록하려 하면 오류를 응답한다.
       - Given: 특정 노선이 등록되어 있고,
       - When: 노선에 등록되어 있는 역이 하행역인 구간을 등록하면,
       - Then: 오류를 응답한다.
2. 지하철 구간 제거
   - [x] 지하철 노선에 구간을 제거한다.
      - Given: 특정 노선에 구간이 2개 이상 등록되어 있고,
      - When: 노선의 하행역을 제거하면,
      - Then: 노선을 조회했을 때 하행역이 제거된다.
   - [x] 지하철 노선에 등록된 역(하행 종점역)만 제거할 수 있다. 즉, 마지막 구간만 제거할 수 있다.
     - Given: 특정 노선에 구간이 2개 이상 등록되어 있고,
     - When: 노선의 하행역이 아닌 역을 제거하면,
     - Then: 오류를 응답한다.
   - [ ] 지하철 노선에 상행 종점역과 하행 종점역만 있는 경우(구간이 1개인 경우) 역을 삭제할 수 없다.
     - Given: 특정 노선에 구간이 1개 등록되어 있고,
     - When: 노선의 하행역을 제거하면,
     - Then: 오류를 응답한다.

## 작업 목록
### 1주차. Step3 - 지하철 구간 관리
1. 구간 등록 기능
   - [x] 노선 구간 등록 API 구현
   - [x] 존재하지 않는 역이 포함된 구간을 노선에 등록 400 오류 응답
   - [x] 존재하지 않는 노선에 구간을 등록하려 하면 404 응답
   - [x] 노선의 하행역과 다른 역이 상행역인 구간을 등록하려 하면 400 응답
   - [x] 이미 해당 노선에 등록되어 있는 역을 새로운 구간의 하행역으로 등록하려 하면 400 응답
   - [x] test fixture 클래스 분리
   - [x] 노선이 구간(역 목록)을 가질 수 있도록 upStationId, downStationsId를 stations로 수정
   - [x] 노선 stations 에 등록된 역 아이디를 사용하여 DB에서 역 정보를 가져오도록 수정
   - [x] 구간 엔티티 추가
2. 구간 제거 기능
   - [x] 구간 제거 API 구현
   - [ ] 노선의 하행역이 아닌 구간을 제거하려 하면 400 응답
   - [ ] 노선에 구간이 하나만 있을 경우 제거하려 하면 400 응답
